"0","wilcoxDEGs <- function(exp_df, clinical1){"
"0","  # exp_df in log2 format"
"0","  exp_df <- 2**(exp_df) - 1"
"0","  re <- lapply(1:nrow(exp_df), function(x){"
"0","    id1 <- clinical1[clinical1$group %in% levels(clinical1$group)[1],]$patient"
"0","    id2 <- clinical1[clinical1$group %in% levels(clinical1$group)[2],]$patient"
"0","    group1 <- exp_df[,colnames(exp_df) %in% id1]"
"0","    group2 <- exp_df[,colnames(exp_df) %in% id2]"
"0","    p <- wilcox.test(as.numeric(group2[x,]), as.numeric(group1[x,]))$p.value"
"0","    logFC <- log2(mean(as.numeric(group2[x,])) / mean(as.numeric(group1[x,])))"
"0","    c(p, logFC)"
"0","  })"
"0","  re <- as.data.frame(do.call(rbind, re))"
"0","  rownames(re) <- rownames(exp_df)"
"0","  colnames(re) <- c(""P.value"", ""LogFC"")"
"0","  re$FDR <- p.adjust(re$P.value, method = ""fdr"") "
"0","  return(re)"
"0","}"
